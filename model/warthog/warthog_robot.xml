<!-- 
    Authors:
        - Alex Gisi (apgisi11@gmail.com)
    Notes:
        - Adapted for use with mujoco_sim.
        - Measurements and inertias adapted from Clearpath's URDF.
        - Collision surfaces not implemented.
        - Suspension/damping between chassis and differential units not implemented (probably only relevant for offroad simulation).
 -->

<mujoco model="warthog">
	<compiler angle="radian" meshdir="meshes/" />

    <!--Meshes-->
    <asset>
        <mesh name="chassis" file="chassis.stl" />
        <mesh name="chassis-collision" file="chassis-collision.stl" />
        <mesh name="wheel" file="wheel.stl" />
        <mesh name="fender" file="fenders.stl" />
        <mesh name="fender-collision" file="fenders-collision.stl" />
        <mesh name="rocker" file="rocker.stl" />
        <mesh name="buttons" file="buttons.stl" />
        <mesh name="light" file="light.stl" />
    </asset>

	<worldbody>
		<body name="warthog" pos="0 0 0.5" quat="1 0 0 0">
            <site name="warthog" pos="0 0 0" />
            <freejoint name="warthog" />

            <geom pos="0 0 0.025" type="mesh" contype="0" conaffinity="0" group="1" rgba="0.15 0.15 0.15 1" mesh="chassis" />

            <body name="chassis">
                <geom name="chassis" type="mesh" rgba="0.2 0.2 0.2 1" mesh="chassis-collision" />
                <inertial pos="0 0 0" mass="100" fullinertia="4.84 15.94 15.93 0 0 0" />
            </body>

            <body name="left_diff_unit" pos="0.0 0.56821 0.0" >
                <inertial pos="0 0.05 0.197" mass="50" fullinertia="1.98 9.135 9.135 0 0 0" />
                <geom name="left_diff_unit_rocker" quat="0.707 0 0 0.707" type="mesh" rgba="0.2 0.2 0.2 1"  contype="0" conaffinity="0" mesh="rocker" />
                <geom name="left_diff_unit_fender" quat="0.707 0 0 0.707" type="mesh" rgba="0.95 0.816 0.082 1" contype="0" conaffinity="0" mesh="fender" />
                <geom name="left_diff_unit_buttons" pos="0 0 0" quat="0.707 0 0 0.707" contype="0" conaffinity="0" type="mesh" mesh="buttons" />
                <geom name="left_diff_unit_headlight" pos="0 -0.029 0" rgba="0.5 0 0 0.8" contype="0" conaffinity="0" type="mesh" mesh="light" />
                <geom name="left_diff_unit_taillight" pos="0 -0.029 0" rgba="0.5 0 0 0.8" quat="0 0 0 1" contype="0" conaffinity="0" type="mesh" mesh="light" />

                <body name="front_left_wheel" pos="0.457367 0.0 -0.012977" quat="1 0 0 0">
                    <inertial pos="0 0 0" mass="15" fullinertia="0.42 0.67 0.416 0 0 0" />
                    <geom name="front_left_wheel_visual" pos="0 0 0" quat="0.707 0 0 0.707" rgba="0.15 0.15 0.15 1" contype="0" conaffinity="0" type="mesh" mesh="wheel" />
                    <joint type="hinge" name="front_left_wheel_joint" axis="0 1 0"/>
                    <geom type="ellipsoid" name="front_left_wheel" size="0.3 0.12 0.3" rgba="1 0 0 0" condim="4" />
                </body>

                <body name="rear_left_wheel" pos="-0.457367 0.0 -0.012977" quat="1 0 0 0">
                    <inertial pos="0 0 0" mass="15" fullinertia="0.42 0.67 0.416 0 0 0" />
                    <geom name="rear_left_wheel_visual" pos="0 0 0" quat="0.707 0 0 0.707" rgba="0.15 0.15 0.15 1" contype="0" conaffinity="0" type="mesh" mesh="wheel" />
                    <joint type="hinge" name="rear_left_wheel_joint" axis="0 1 0"/>
                    <geom type="ellipsoid" name="rear_left_wheel" size="0.3 0.12 0.3" rgba="1 0 0 0" condim="4" />
                </body>
            </body>

            <body name="right_diff_unit" pos="0.0 -0.56821 0.0" >
                <inertial pos="0 -0.05 0.197" mass="50" fullinertia="1.98 9.135 9.135 0 0 0" />
                <geom name="right_diff_unit_rocker" quat="0.707 0 0 -0.707" type="mesh" rgba="0.2 0.2 0.2 1"  contype="0" conaffinity="0" mesh="rocker" />
                <geom name="right_diff_unit_fender" quat="0.707 0 0 -0.707" type="mesh" rgba="0.95 0.816 0.082 1" contype="0" conaffinity="0" mesh="fender" />
                <geom name="right_diff_unit_buttons" pos="0 0 0" quat="0.707 0 0 -0.707" contype="0" conaffinity="0" type="mesh" mesh="buttons" />
                <geom name="right_diff_unit_headlight" pos="0 0.029 0" rgba="0.5 0 0 0.8" contype="0" conaffinity="0" type="mesh" mesh="light" />
                <geom name="right_diff_unit_taillight" pos="0 0.029 0" quat="0 0 0 -1" rgba="0.5 0 0 0.8" contype="0" conaffinity="0" type="mesh" mesh="light" />

                <body name="front_right_wheel" pos="0.457367 -0.0 -0.012977" quat="1 0 0 0">
                    <inertial pos="0 0 0" mass="15" fullinertia="0.42 0.67 0.416 0 0 0" />
                    <geom name="front_right_wheel_visual" pos="0 0 0" quat="0.707 0 0 0.707" rgba="0.15 0.15 0.15 1" contype="0" conaffinity="0" type="mesh" mesh="wheel" />
                    <joint type="hinge" name="front_right_wheel_joint" axis="0 1 0"/>
                    <geom type="ellipsoid" name="front_right_wheel" size="0.3 0.12 0.3" rgba="1 0 0 0" condim="4" />
                </body>

                <body name="rear_right_wheel" pos="-0.457367 0.0 -0.012977" quat="1 0 0 0">
                    <inertial pos="0 0 0" mass="15" fullinertia="0.42 0.67 0.416 0 0 0" />
                    <geom name="rear_right_wheel_visual" pos="0 0 0" quat="0.707 0 0 0.707" rgba="0.15 0.15 0.15 1" contype="0" conaffinity="0" type="mesh" mesh="wheel" />
                    <joint type="hinge" name="rear_right_wheel_joint" axis="0 1 0"/>
                    <geom type="ellipsoid" name="rear_right_wheel" size="0.3 0.12 0.3" rgba="1 0 0 0" condim="4" />
                </body>
            </body>
        </body>
	</worldbody>

    <!-- <tendon>
        <fixed name="left_differential">
            <joint joint="front_left_wheel_joint" coef="1" />
            <joint joint="rear_left_wheel_joint" coef="1" />
        </fixed>

        <fixed name="right_differential">
            <joint joint="front_right_wheel_joint" coef="1" />
            <joint joint="rear_right_wheel_joint" coef="1" />
        </fixed>
    </tendon> -->

    <!--ACTUATORS-->
    <actuator>
        <velocity joint="front_left_wheel_joint" name="front_left_wheel_joint" ctrlrange="-16 16" ctrllimited="true" kv="50" gear="10 0 0 0 0 0" />
        <velocity joint="front_right_wheel_joint" name="front_right_wheel_joint" ctrlrange="-16 16" ctrllimited="true" kv="50" gear="10 0 0 0 0 0" />
        <velocity joint="rear_right_wheel_joint" name="rear_right_wheel_joint" ctrlrange="-16 16" ctrllimited="true" kv="50" gear="10 0 0 0 0 0" />
        <velocity joint="rear_left_wheel_joint" name="rear_left_wheel_joint" ctrlrange="-16 16" ctrllimited="true" kv="50" gear="10 0 0 0 0 0" />
        
        <!-- <velocity name="left" tendon="left_differential" gear="1 0 0 0 0 0" ctrlrange="-1000 1000" ctrllimited="true" />
        <velocity name="right" tendon="right_differential" gear="1 0 0 0 0 0" ctrlrange="-1000 1000" ctrllimited="true" /> -->
       
    </actuator>
</mujoco>